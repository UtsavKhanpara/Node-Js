<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Quiz App</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
  </head>
  <body class="bg-light">
    <div class="container py-5">
      <h1 class="text-center mb-4">Quiz App ğŸ“</h1>

      <!-- Quiz Card -->
      <div class="card shadow p-4" id="quizCard">
        <h4 id="questionText">Loading...</h4>
        <div id="options" class="mt-3"></div>
        <button id="nextBtn" class="btn btn-primary mt-3" disabled>Next</button>
      </div>

      <!-- Score Display -->
      <div class="mt-4 text-center">
        <h5 id="scoreText"></h5>
      </div>

      <!-- Result Section (hidden initially) -->
      <div
        id="resultSection"
        class="card shadow p-4 text-center mt-4 d-none"
      >
        <h3>ğŸ‰ Quiz Finished ğŸ‰</h3>
        <p class="lead" id="finalScore"></p>
        <button class="btn btn-success mt-3" onclick="restartQuiz()">Restart Quiz</button>
      </div>
    </div>

   <script>
  let score = 0;
  let total = 0;
  let currentQuestion = null;
  const maxQuestions = 10; // à¤•à¤¿à¤¤à¤¨à¥‡ questions à¤ªà¥‚à¤›à¤¨à¥‡ à¤¹à¥ˆà¤‚

  async function loadQuestion() {
    if (total >= maxQuestions) {
      endQuiz();
      return;
    }

    const res = await fetch("/api/questions/random");
    currentQuestion = await res.json();
    total++;

    document.getElementById("questionText").innerText =
      currentQuestion.questionText;

    const optionsDiv = document.getElementById("options");
    optionsDiv.innerHTML = "";

    currentQuestion.options.forEach((opt, index) => {
      const btn = document.createElement("button");
      btn.className =
        "btn btn-outline-secondary d-block w-100 text-start mb-2";
      btn.innerText = opt;
      btn.onclick = () => checkAnswer(index, btn);
      optionsDiv.appendChild(btn);
    });

    document.getElementById("nextBtn").disabled = true;
  }

  function checkAnswer(index, btn) {
    if (index === currentQuestion.correctAnswer) {
      btn.classList.remove("btn-outline-secondary");
      btn.classList.add("btn-success");
      score++;
    } else {
      btn.classList.remove("btn-outline-secondary");
      btn.classList.add("btn-danger");
    }

    document.getElementById(
      "scoreText"
    ).innerText = `Score: ${score} / ${total}`;

    document.querySelectorAll("#options button").forEach((b) => {
      b.disabled = true;
    });

    document.getElementById("nextBtn").disabled = false;
  }

  function endQuiz() {
    // Redirect to result page with query params
    window.location.href = `/result?score=${score}&total=${total}`;
  }

  document.getElementById("nextBtn").addEventListener("click", loadQuestion);

  // Start quiz
  loadQuestion();
</script>

  </body>
</html>
